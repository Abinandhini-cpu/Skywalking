# How to build project
This document helps people to compile and build the project in your maven and set your IDE.

## Build Project
**Because we are using Git submodule, we recommend don't use `GitHub` tag or release page to download source codes for compiling.**

### Build from GitHub
1. Prepare git, JDK8 and maven3
1. `git clone https://github.com/apache/incubator-skywalking.git`
1. `cd incubator-skywalking/`
1. Switch to the tag by using `git checkout [tagname]` (Optional, switch if want to build a release from source codes)
1. `git submodule init`
1. `git submodule update`
1. Run `mvn clean package -DskipTests`
1. All packages are in `/dist`.(.tar.gz for Linux and .zip for Windows).

### Build from Apache source codes
1. Prepare JDK8 and maven3
1. Run `mvn clean package -DskipTests`
1. All packages are in `/dist`.(.tar.gz for Linux and .zip for Windows).

## Setup your IntelliJ IDEA
1. Import the project as a maven project
1. Run `mvn compile -Dmaven.test.skip=true` to compile project and generate source codes. Because we use gRPC and protobuf.
1. Set **Generated Source Codes** folders.
    * `grpc-java` and `java` folders in **apm-protocol/apm-network/target/generated-sources/protobuf**
    * `grpc-java` and `java` folders in **apm-collector/apm-collector-remote/apm-remote-grpc-provider/target/generated-sources/protobuf**
    
## Setup your Eclipse IDE
1. Import the project as a maven project
2. Add the following two plugin configurations to the incubator-skywalking/pom.xml file of the home directory
    --1):Multi source directory support
```
<plugin>
	<groupId>org.codehaus.mojo</groupId>
	<artifactId>build-helper-maven-plugin</artifactId>
	<version>1.8</version>
	<executions>
		<execution>
		<id>add-source</id>
		<phase>generate-sources</phase>
		<goals>
			<goal>add-source</goal>
		</goals>
		<configuration>
			<sources>
				<source>src/java/main</source>
				<source>apm-protocol/apm-network/target/generated-sources/protobuf</source>
				<source>apm-collector/apm-collector-remote/collector-remote-grpc-provider/target/generated-sources/protobuf</source>
		   </sources>
		</configuration>
	</execution>
	</executions>
</plugin>
```
    --2):Support for multi source directory, but eclipse's M2e plug-in does not support execution's solution configuration.
```
<pluginManagement>
    <plugins>
    <!--This plugin's configuration is used to store Eclipse m2e settings 
only. It has no influence on the Maven build itself. -->
        <plugin>
            <groupId>org.eclipse.m2e</groupId>
            <artifactId>lifecycle-mapping</artifactId>
            <version>1.0.0</version>
            <configuration>
                <lifecycleMappingMetadata>
		    <pluginExecutions>
		        <pluginExecution>
			    <pluginExecutionFilter>
			        <groupId>org.codehaus.mojo</groupId>
			        <artifactId>build-helper-maven-plugin</artifactId>
			        <versionRange>[1.8,)</versionRange>
			        <goals>
				    <goal>add-source</goal>
				</goals>
				</pluginExecutionFilter>
				<action>
				    <ignore></ignore>
				</action>
			    </pluginExecution>
		   </pluginExecutions>
               </lifecycleMappingMetadata>
          </configuration>
       </plugin>
    </plugins>
</pluginManagement>
```
3. Adding Google guava dependency to apm-collector-remote/collector-remote-grpc-provider/pom.xml files
```
<dependency>
   <groupId>com.google.guava</groupId>
   <artifactId>guava</artifactId>
</dependency>
```
4. Run `mvn compile -Dmaven.test.skip=true`
5. Run `maven update`,Must remove the clean projects item before maven update(This will be clear the proto conversion Java file generated by the complie)
6. Run `mvn compile` complie collector-remote-grpc-provider and apm-protocol
7. Refresh project

## Building Resin-3, Resin-4, and OJDBC sdk plugins
Due to license incompatibilities/restrictions these plugins under `apm-sniffer/apm-sdk-plugin/` are not built by default.
Download them manually into the `ci-dependencies/` directory and the plugins will be included in the maven reactor and built.
The names of the artifacts downloaded and placed in the `ci-dependencies/` directory must be exact:
* resin-3.0.9.jar
* resin-4.0.41.jar
* ojdbc14-10.2.0.4.0.jar
